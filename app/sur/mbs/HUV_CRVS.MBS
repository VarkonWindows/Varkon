!********************************************** 
! Curves for canopy
! 1994-03-02  Gunnar Liden    
!********************************************** 

GLOBAL GEOMETRY MODULE huv_crvs (

INT    graphic:= 2 >"@ Graphical representation 1= or 2= ";

FLOAT  v1:=  0.0 >"@ Variabel  1";
FLOAT  v2:=  0.0 >"@ Variabel  2";
FLOAT  v3:=  0.0 >"@ Variabel  3";
FLOAT  v4:=  0.0 >"@ Variabel  4";
FLOAT  v5:=  0.0 >"@ Variabel  5";
FLOAT  v6:=  0.0 >"@ Variabel  6";
FLOAT  v7:=  0.0 >"@ Variabel  7";
FLOAT  v8:=  0.0 >"@ Variabel  8";
FLOAT  v9:=  0.0 >"@ Variabel  9";
FLOAT  v10:= 0.0 >"@ Variabel 10");


! Internal variables:

  INT bflag1;     ! For the graphical representation
  INT bflag2;     ! For the graphical representation


BEGINMODULE



!      1. Initiations and checks 
!      ========================== 


!      2. Graphical representation 
!      =========================== 

  IF graphic = 1 THEN 
      bflag1:= 0;  
      bflag2:= 0;  
  ELIF graphic = 2 THEN 
      bflag1:= 0;  
      bflag2:= 1;  
  ELSE 
      bflag1:= 1;  
      bflag2:= 1;  
  ENDIF; 




!      3. Creation of curve 
!      ==================== 

CUR_CONIC(#1,"FREE",
!vec( 4030.411300,  404.162800, 3726.994500), ! P 1
!vec( 4039.595767,  404.763809, 3723.084979), ! T 
!     0.50000000,                             ! P value
vec( 4087.794500,  407.715400, 3709.303500), ! P 2
vec( 4097.479039,  408.286369, 3706.877866), ! T 
     0.50000000,                             ! P value
vec( 4204.203200,  414.001200, 3684.821500), ! P 3
vec( 4214.089381,  414.486713, 3683.397528), ! T 
     0.50000000,                             ! P value
vec( 4371.517300,  420.700400, 3678.298400), ! P 4
vec( 4381.511878,  421.019829, 3678.378276), ! T 
     0.50000000,                             ! P value
vec( 4866.087500,  428.094100, 3662.556300), ! P 5
vec( 4876.025056,  428.094100, 3661.440509), ! T 
     0.50000000,                             ! P value
vec( 5751.602200,  417.634000, 3563.130500), ! P 6
vec( 5761.538603,  417.481697, 3562.014839), ! T 
     0.50000000,                             ! P value
vec( 6218.180000,  409.576100, 3532.911700), ! P 7
vec( 6228.177084,  409.346543, 3532.836733), ! T 
     0.50000000,                             ! P value
vec( 6650.000000,  384.000000, 3529.673500), ! P 8
vec( 6659.961226,  383.123412, 3529.598802)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000,  303.000000, 3524.799200), ! P 9
!vec( 7309.879817,  301.456066, 3524.725112), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000,  185.015000, 3519.137500), ! P 10
!vec( 8064.879817,  183.471066, 3519.063412)  ! T 
          :BLANK=bflag1); 

CUR_CONIC(#2,"FREE",
!vec( 4028.225400,  404.054000, 3722.704500), ! P 1
!vec( 4037.370731,  404.653891, 3718.704118), ! T 
!     0.50000000,                             ! P value
vec( 4087.157200,  407.703500, 3704.346700), ! P 2
vec( 4096.841739,  408.274469, 3701.921066), ! T 
     0.50000000,                             ! P value
vec( 4203.566000,  414.031400, 3679.864700), ! P 3
vec( 4213.394682,  414.524173, 3678.088696), ! T 
     0.50000000,                             ! P value
vec( 4368.353000,  421.431600, 3653.686000), ! P 4
vec( 4378.244190,  421.826233, 3652.268744), ! T 
     0.50000000,                             ! P value
vec( 4857.987400,  432.781300, 3599.553900), ! P 5
vec( 4867.955425,  432.781300, 3598.754857), ! T 
     0.50000000,                             ! P value
vec( 5747.121600,  419.109400, 3528.280400), ! P 6
vec( 5757.088086,  418.933671, 3527.481481), ! T 
     0.50000000,                             ! P value
vec( 6215.723800,  409.856200, 3513.807600), ! P 7
vec( 6225.720209,  409.598925, 3513.732638), ! T 
     0.50000000,                             ! P value
vec( 6650.000000,  384.000000, 3510.551000), ! P 8
vec( 6659.961226,  383.123412, 3510.476302)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000,  303.000000, 3505.676700), ! P 9
!vec( 7309.879817,  301.456066, 3505.602612), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000,  185.015000, 3500.015000), ! P 10
!vec( 8064.879817,  183.471066, 3499.940912)  ! T 
          :BLANK=bflag1); 

CUR_CONIC(#3,"FREE",
!vec( 3848.570000,    0.000000, 3370.110000), ! P 1
!vec( 3857.480065,    0.000000, 3365.570095), ! T 
!     0.50000000,                             ! P value
vec( 4035.091200,    0.000000, 3299.376600), ! P 2
vec( 4044.688706,    0.000000, 3296.568065), ! T 
     0.50000000,                             ! P value
vec( 4150.769500,    0.000000, 3269.213400), ! P 3
vec( 4160.508040,    0.000000, 3266.941651), ! T 
     0.50000000,                             ! P value
vec( 4314.612900,    0.000000, 3235.695300), ! P 4
vec( 4324.454727,    0.000000, 3233.923734), ! T 
     0.50000000,                             ! P value
vec( 4802.800000,    0.000000, 3170.306100), ! P 5
vec( 4812.750794,    0.000000, 3169.315295), ! T 
     0.50000000,                             ! P value
vec( 5693.688200,    0.000000, 3112.674600), ! P 6
vec( 5703.684342,    0.000000, 3112.396833), ! T 
     0.50000000,                             ! P value
vec( 6163.347500,    0.000000, 3106.423900), ! P 7
vec( 6173.346776,    0.000000, 3106.544244), ! T 
     0.50000000,                             ! P value
vec( 6650.000000,    0.000000, 3136.276100), ! P 8
vec( 6659.946520,    0.000000, 3137.308930)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000,    0.000000, 3215.826100), ! P 9
!vec( 7309.914828,    0.000000, 3217.128474), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000,    0.000000, 3315.000000), ! P 10
!vec( 8064.914828,    0.000000, 3316.302374)  ! T 
          :BLANK=bflag1); 

CUR_CONIC(#4,"FREE",
!vec( 4110.067800,  408.127800, 3883.329100), ! P 1
!vec( 4119.966510,  408.756997, 3882.056446), ! T 
!     0.50000000,                             ! P value
vec( 4110.166900,  408.134100, 3883.316400), ! P 2
vec( 4120.065771,  408.760722, 3882.043726), ! T 
     0.50000000,                             ! P value
vec( 4227.779200,  410.930700, 3868.195300), ! P 3
vec( 4237.697551,  410.915187, 3866.920121), ! T 
     0.50000000,                             ! P value
vec( 4393.197600,  410.672000, 3846.927800), ! P 4
vec( 4403.115951,  410.656487, 3845.652621), ! T 
     0.50000000,                             ! P value
vec( 4881.716700,  409.908000, 3784.120100), ! P 5
vec( 4891.635051,  409.892487, 3782.844921), ! T 
     0.50000000,                             ! P value
vec( 5765.407200,  408.525800, 3670.506100), ! P 6
vec( 5775.325551,  408.510287, 3669.230921), ! T 
     0.50000000,                             ! P value
vec( 6228.220100,  407.802000, 3611.003400), ! P 7
vec( 6238.138451,  407.786487, 3609.728221), ! T 
     0.50000000,                             ! P value
vec( 6650.000000,  384.000000, 3600.000000), ! P 8
vec( 6659.956629,  383.123817, 3600.312812)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000,  303.000000, 3629.767100), ! P 9
!vec( 7309.866423,  301.458159, 3630.292868), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000,  185.015000, 3670.000000), ! P 10
!vec( 8064.866423,  183.473159, 3670.525768)  ! T 
          :BLANK=bflag2); 


CUR_CONIC(#5,"FREE",
!vec( 3848.570000,  395.111400, 3370.110000), ! P 1
!vec( 3857.464076,  395.710215, 3365.578242), ! T 
!     0.50000000,                             ! P value
vec( 4035.091200,  406.729100, 3299.376600), ! P 2
vec( 4044.673218,  407.296992, 3296.572597), ! T 
     0.50000000,                             ! P value
vec( 4150.769500,  414.031400, 3269.213400), ! P 3
vec( 4160.496299,  414.522287, 3266.944390), ! T 
     0.50000000,                             ! P value
vec( 4314.612900,  421.431600, 3235.695300), ! P 4
vec( 4324.447078,  421.825777, 3233.925111), ! T 
     0.50000000,                             ! P value
vec( 4802.800000,  432.781300, 3170.306100), ! P 5
vec( 4812.750794,  432.781300, 3169.315295), ! T 
     0.50000000,                             ! P value
vec( 5693.688200,  419.109400, 3112.674600), ! P 6
vec( 5703.682810,  418.934349, 3112.396875), ! T 
     0.50000000,                             ! P value
vec( 6163.347500,  409.856200, 3106.423900), ! P 7
vec( 6173.343483,  409.599582, 3106.544205), ! T 
     0.50000000,                             ! P value
vec( 6650.000000,  384.000000, 3136.276100), ! P 8
vec( 6659.908636,  383.128040, 3137.304996)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000,  303.000000, 3215.826100), ! P 9
!vec( 7309.797919,  301.468864, 3217.113117), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000,  185.015000, 3315.000000), ! P 10
!vec( 8064.797919,  183.483864, 3316.287017)  ! T 
          :BLANK=bflag2); 


CUR_CONIC(#6,"FREE",
!vec( 3848.570000, -395.111400, 3370.110000), ! P 1
!vec( 3857.464076, -395.710215, 3365.578242), ! T 
!     0.50000000,                             ! P value
vec( 4035.091200, -406.729100, 3299.376600), ! P 2
vec( 4044.673218, -407.296992, 3296.572597), ! T 
     0.50000000,                             ! P value
vec( 4150.769500, -414.031400, 3269.213400), ! P 3
vec( 4160.496299, -414.522287, 3266.944390), ! T 
     0.50000000,                             ! P value
vec( 4314.612900, -421.431600, 3235.695300), ! P 4
vec( 4324.447078, -421.825777, 3233.925111), ! T 
     0.50000000,                             ! P value
vec( 4802.800000, -432.781300, 3170.306100), ! P 5
vec( 4812.750794, -432.781300, 3169.315295), ! T 
     0.50000000,                             ! P value
vec( 5693.688200, -419.109400, 3112.674600), ! P 6
vec( 5703.682810, -418.934349, 3112.396875), ! T 
     0.50000000,                             ! P value
vec( 6163.347500, -409.856200, 3106.423900), ! P 7
vec( 6173.343483, -409.599582, 3106.544205), ! T 
     0.50000000,                             ! P value
vec( 6650.000000, -384.000000, 3136.276100), ! P 8
vec( 6659.908636, -383.128040, 3137.304996)  ! T 
!     0.50000000,                             ! P value
!vec( 7300.000000, -303.000000, 3215.826100), ! P 9
!vec( 7309.797919, -301.468864, 3217.113117), ! T 
!     0.50000000,                             ! P value
!vec( 8055.000000, -185.015000, 3315.000000), ! P 10
!vec( 8064.797919, -183.483864, 3316.287017)  ! T 
          :BLANK=bflag2); 

CUR_CONIC(#7,"FREE",
vec(    0.000   ,  0.5000000,    0.000000), ! P 1
vec(   10.000   ,  0.5000000,    0.000000), ! T
     0.20000000,                             ! P value
vec( 5765.407200-4110.1669,    0.5000000,    0.000000), ! P 6
vec( 5775.407200-4110.1669,    0.5000000,    0.000000)  ! T
!Qvec( 1000.000000,    5.000000,    0.000000), ! P 9
!Qvec( 9000.000000,    5.000000,    0.000000)  ! T
          :BLANK=bflag2); 

CUR_CONIC(#8,"FREE",
!vec( 4110.067800-4110.1669,    4.169313/10.0,    0.000000), ! P 1
!vec( 4120.067800-4110.1669,    4.168916/10.0,    0.000000), ! T
!     0.20000000,                             ! P value
vec( 4110.166900-4110.1669,    4.165166/10.0,    0.000000), ! P 2
vec( 4120.166900-4110.1669,    4.164129/10.0,    0.000000), ! T
     0.20000000,                             ! P value
vec( 4227.779200-4110.1669,    4.147528/10.0,    0.000000), ! P 3
vec( 4237.779200-4110.1669,    4.146528/10.0,    0.000000), ! T
     0.20000000,                             ! P value
vec( 4393.197600-4110.1669,    4.142000/10.0,    0.000000), ! P 4
vec( 4403.197600-4110.1669,    4.142000/10.0,    0.000000), ! T
     0.20000000,                             ! P value
vec( 4881.716700-4110.1669,    4.142000/10.0,    0.000000), ! P 5
vec( 4891.716700-4110.1669,    4.142000/10.0,    0.000000), ! T
     0.20000000,                             ! P value
vec( 5765.407200-4110.1669,    4.142000/10.0,    0.000000), ! P 6
vec( 5775.407200-4110.1669,    4.142000/10.0,    0.000000)  ! T
!     0.20000000,                             ! P value
!vec( 6228.220100-4110.1669,    4.142000/10.0,    0.000000), ! P 7
!vec( 6238.220100-4110.1669,    4.142000/10.0,    0.000000), ! T
!     0.20000000,                             ! P value
!vec( 6650.000000-4110.1669,    4.142000/10.0,    0.000000), ! P 8
!vec( 6660.000000-4110.1669,    4.142000/10.0,    0.000000), ! T
!     0.20000000,                             ! P value
!vec( 7300.000000-4110.1669,    4.142000/10.0,    0.000000), ! P 9
!vec( 7310.000000-4110.1669,    4.144515/10.0,    0.000000), ! T
!     0.20000000,                             ! P value
!vec( 8055.000000-4110.1669,    4.600000/10.0,    0.000000), ! P 10
!vec( 8065.000000-4110.1669,    4.606704/10.0,    0.000000)  ! T
          :BLANK=bflag2); 

  CSYS_3P(#21,"1450",VEC(0,0,0),
      VEC(0,0,0)+VEC(0.991836252,0,-0.127513032),
            VEC(0,0,0)+VEC(0,1,0):BLANK=bflag2);

  MODE_LOCAL(#21);
  LIN_FREE(#22,VEC(3600.000,0,3500),
     VEC(3600.0000,0,3500)
     +VEC( 5765.407200-4110.1669,0,0):BLANK=1);
!Fungerar  LIN_FREE(#22,VEC(3600.000,0,3500),
!Fungerar     VEC(3600.0000,0,3500)
!Fungerar     +VEC( 5765.407200-4110.1669,0,0):BLANK=1);
 
  MODE_GLOBAL();

   CUR_COMP(#9,#22);

  PART(#23,CURARROW(#9, 0.50));

!      4. Registration of surface curve 
!      ================================ 

!      (Link between curve and # - name 

  GROUP(#11, "LIM01" , #1 ); 
  GROUP(#12, "LIM02" , #2 ); 
  GROUP(#13, "LIM03" , #3 ); 
  GROUP(#14, "TAN01" , #4 ); 
  GROUP(#15, "TAN02" , #5 ); 
  GROUP(#16, "TAN03" , #6 ); 
  GROUP(#17, "PFN01" , #7 ); 
  GROUP(#18, "PFN02" , #8 ); 
  GROUP(#19, "SPINE" , #9 ); 
  


ENDMODULE
